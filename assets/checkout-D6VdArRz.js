import{g as r,l as s}from"./utils-xO2efT-X.js";import{E as c}from"./ExternalServices-Cs-SxY3_.js";const l=new c;function h(o){return o.map(t=>({id:t.Id,name:t.Name,price:t.FinalPrice,quantity:t.quantity}))}function u(o){const e=new FormData(o),t={};return e.forEach(function(i,n){t[n]=i}),t}class m{constructor(e,t){this.key=e,this.outputElement=t,this.list=[],this.itemTotal=0,this.shipping=0,this.tax=0,this.orderTotal=0}init(){this.list=r(this.key),this.calculateItemSummary()}returnCartSubtotal(){let e=0;return this.list.forEach(t=>{e+=t.FinalPrice*t.quantity}),e=parseFloat(e.toFixed(2)),e}getCartQuantity(){let e=0;return this.list.forEach(t=>{e+=t.quantity}),e}getShipping(){return this.getCartQuantity()*2+8}getTax(){return parseFloat((this.itemTotal*.06).toFixed(2))}calculateOrderTotal(){this.tax=this.getTax(),this.shipping=this.getShipping(),this.itemTotal=this.returnCartSubtotal(),this.orderTotal=this.itemTotal+this.shipping+this.tax,this.displayOrderTotals()}displayOrderTotals(){const e=document.querySelector(`#${this.outputElement} .cart-total`),t=document.querySelector(`#${this.outputElement} .cart-tax`),i=document.querySelector(`#${this.outputElement} .cart-shipping`),n=document.querySelector(`#${this.outputElement} .cart-final-price`);e.textContent=this.itemTotal,i.textContent=this.shipping,t.textContent=this.tax,n.textContent=this.orderTotal}calculateItemSummary(){this.itemTotal=this.returnCartSubtotal(),this.shipping=this.getShipping(),this.tax=this.getTax(),this.orderTotal=this.itemTotal+this.shipping+this.tax,this.displayOrderTotals()}async checkout(){const e=document.getElementById("checkout-form"),t=u(e);t.orderDate=new Date().toISOString(),t.items=h(this.list),t.orderTotal=this.orderTotal,t.tax=this.tax,t.shipping=this.shipping,console.log(t);try{const i=await l.checkout(t);console.log(i)}catch(i){console.log(i)}}}document.addEventListener("DOMContentLoaded",()=>{document.getElementById("cardNumber").value=0x4626dbf9a01f2,document.getElementById("code").value=123,document.getElementById("expiration").value="8/28",document.getElementById("zip").value="68137"});const a=new m("so-cart","price-details");a.init();s();document.querySelector("#zip").addEventListener("blur",a.calculateOrderTotal.bind(a));document.querySelector("#checkout-form").addEventListener("submit",o=>{o.preventDefault(),a.checkout()});
